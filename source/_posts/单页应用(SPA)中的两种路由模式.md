---
title: 单页应用(SPA)中的两种路由模式
date: 2023-09-24
categories: 前端技术
tags: [Web]

---

# 什么是单页应用中的路由模式

在单页面应用（SPA）中，路由模式指的是前端应用程序如何根据URL的变化来展示不同的内容或页面。SPA通常是在加载初始页面后，通过JavaScript动态地更新页面内容，而不是通过每次页面跳转都向服务器请求新的页面。SPA中的常见路由模式有两种，history模式与hash模式。

# history路由模式

## 原理

- History 路由模式是基于 HTML5 History API 实现的前端路由方式。

- HTML5 History API 提供了 `pushState()`，`replaceState()` 和 `popstate` 事件，使得前端可以操作浏览器的历史记录栈。

- 阻止原生的history行为，并在服务端进行相应设置，即始终返回指定页面。

## 实现步骤

**1.初始化路由**

- 首先，需要在页面加载时初始化路由系统，监听`popstate`事件。

- 在初始化时，通常会定义路由规则和对应的处理函数。

**2.路由跳转**

- 当用户点击链接或执行某些操作导致路由发生变化时，可以使用 `pushState()` 或 `replaceState()` 方法来改变URL。

- `pushState()` 会向浏览器历史栈中添加一个新的状态，并改变当前URL，但不会刷新页面。

- `replaceState()` 会替换当前的历史记录条目，不会添加新的状态。

**3.监听路由变化**

- 监听 `popstate` 事件，当用户点击浏览器的前进或后退按钮时，会触发该事件。

- 在 `popstate` 事件处理函数中，可以根据新的URL状态执行相应的操作，例如更新页面内容。

**4.服务器端配置**

- 使用 History 路由模式时，需要在服务器端配置，以确保在直接访问特定路由时返回正确的页面。

- 通常会配置一个通配符路由，使得所有路由都返回前端的入口页面，由前端路由系统接管路由逻辑。

## 优缺点

**优点**：

- URL更加美观，不依赖"#"

- 对SEO更友好，搜索引擎可以正确解析页面内容

- 用户体验更好，可以实现无刷新页面加载。

**缺点**：

- 需要服务器端配合，以处理直接访问特定路由的情况

- 需要前端路由系统来管理路由规则及处理函数

# hash路由模式

## 原理

- Hash 路由模式是一种基于浏览器 URL 中的哈希（`#`）来实现前端路由的方式。

- 当 URL 中的哈希值发生变化时，浏览器不会重新加载页面，而是通过监听 `hashchange` 事件来更新页面内容。

## 实现步骤

**1.初始化路由**

- 在页面加载时，需要初始化路由系统，监听 `hashchange` 事件。

- 定义路由规则和对应的处理函数，通常会将路由规则与哈希值进行映射。

**2.路由跳转**

- 当用户点击链接或执行某些操作导致路由发生变化时，可以通过修改 URL 的哈希值来触发路由变化。例如，通过修改 `window.location.hash` 的值来改变当前页面的哈希值。

**3.监听路由变化**

- 监听 `hashchange` 事件，当 URL 中的哈希值发生变化时会触发该事件。

- 在 `hashchange` 事件处理函数中，根据新的哈希值执行相应的路由处理逻辑，例如更新页面内容。

## 优缺点

**优点**

- 实现简单，不需要服务器端配合

- 兼容性好，适用于旧版本浏览器

**缺点**

- URL不够美观，带有"#"号

- 不利于SEO，搜索引擎可能无法正确解析页面内容。
